<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admit Card Generator</title>
  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --card-bg: #ffffff; --ink: #111827; }
    html,body{ font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; background:#f8fafc; color:var(--ink);} 
    .glass{ background:rgba(255,255,255,.8); backdrop-filter: blur(10px);} 
    .scrollbar-hide::-webkit-scrollbar{ display:none; }
  </style>
  <!-- html2pdf.js for HQ PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js" defer></script>
  <!-- PDF.js for text extraction + image fallback -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.2.67/pdf.min.js"></script>
  <script>
    // Configure the worker for pdf.js
    if (window['pdfjsLib']) {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.2.67/pdf.worker.min.js';
    }
  </script>
  <!-- Tesseract.js for OCR (images / scanned PDFs) -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <!-- Day.js for date formatting -->
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
</head>
<body>
  <header class="w-full border-b bg-white/70 sticky top-0 z-30">
    <div class="max-w-6xl mx-auto flex items-center justify-between p-4">
      <div class="flex items-center gap-3">
        <img src="https://i.ibb.co/nMC0877T/UNIVERSITY-UPDATES-LOGO-removebg-preview.png" alt="Logo" class="h-10 w-auto"/>
        <h1 class="text-xl md:text-2xl font-bold tracking-tight">Admit Card Generator</h1>
      </div>
    </div>
  </header>
  
  <style>
    body { font-family: Arial, sans-serif; background-color: #f4f4f9; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
    h1, h2 { color: #333; text-align: center; }
    #form-container { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: 100%; max-width: 900px; margin-bottom: 20px; }
    .entry-toggle { display: flex; justify-content: center; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 6px; overflow: hidden; }
    .toggle-btn { flex: 1; padding: 12px; border: none; background-color: #f0f0f0; cursor: pointer; font-size: 16px; font-weight: bold; color: #555; transition: background-color 0.3s, color 0.3s; }
    .toggle-btn.active { background-color: #007BFF; color: white; }
    #auto-fill-section { text-align: center; padding: 20px; border: 2px dashed #ccc; border-radius: 8px; }
    #auto-fill-section label { font-weight: bold; font-size: 18px; display: block; margin-bottom: 15px; }
    .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .form-group { display: flex; flex-direction: column; }
    .form-group label { margin-bottom: 5px; font-weight: bold; color: #555; }
    .form-group input, .form-group select { padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
    #papers-container { margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px; }
    .paper-entry { display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 10px; align-items: center; margin-bottom: 10px; background: #f9f9f9; padding: 10px; border-radius: 4px; }
    .action-buttons { display: flex; justify-content: center; gap: 15px; margin-top: 25px; }
    button { padding: 12px 25px; border: none; border-radius: 5px; background-color: #007BFF; color: white; font-size: 16px; font-weight: bold; cursor: pointer; transition: background-color 0.3s; }
    button:hover { background-color: #0056b3; }
    #downloadBtn { background-color: #28a745; }
    #downloadBtn:hover { background-color: #1e7e34; }
    #admit-card-wrapper { width: 100%; max-width: 800px; margin-top: 20px; padding: 20px; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    #admit-card-content { border: 2px solid black; padding: 15px; }
    .header { display: flex; align-items: center; justify-content: space-between; border-bottom: 2px solid black; padding-bottom: 10px; margin-bottom: 10px; }
    .header img { height: 60px; width: auto; }
    .header h3 { flex: 1; text-align: center; margin: 0; font-size: 20px; }
    .header-right { width: 60px; }
    .header p { margin: 5px 0; text-align: center; flex-basis: 100%; }
    .sub-header { text-align: center; font-weight: bold; padding: 5px 0; margin-bottom: 10px; }
    .sub-header h4 { margin: 0; padding: 5px 10px; border: 1px solid black; border-radius: 5px; display: inline-block; }
    .details-table { width: 100%; margin-top: 10px; border-collapse: collapse; }
    .details-table td { padding: 5px; font-size: 14px; }
    .details-table .label { font-weight: bold; width: 20%; }
    .details-table .value { width: 30%; }
    .papers-table { width: 100%; margin-top: 15px; border-collapse: collapse; font-size: 12px; }
    .papers-table th, .papers-table td { border: 1px solid black; padding: 6px; text-align: left; }
    .papers-table th { background-color: #f2f2f2; font-weight: bold; }
    .footer-note { font-size: 12px; margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>

  <!-- FORM -->
  <div id="form-container">
    <h1>Admit Card Generator</h1>
    <div class="entry-toggle">
      <button class="toggle-btn active" id="manualBtn">Manual Entry</button>
      <button class="toggle-btn" id="autoBtn">Auto-fill from Upload</button>
    </div>

    <!-- Manual Entry -->
    <div id="manual-form">
      <form id="admitCardForm">
        <h2>Student Details</h2>
        <div class="form-grid">
          <div class="form-group"><label for="candidateName">Candidate Name:</label><input type="text" id="candidateName" required></div>
          <div class="form-group"><label for="fatherName">Father's Name:</label><input type="text" id="fatherName" required></div>
          <div class="form-group"><label for="motherName">Mother's Name:</label><input type="text" id="motherName" required></div>
          <div class="form-group"><label for="rollNumber">Roll Number:</label><input type="text" id="rollNumber" required></div>
          <div class="form-group"><label for="enrollmentNumber">Enrollment Number:</label><input type="text" id="enrollmentNumber" required></div>
          <div class="form-group"><label for="course">Course:</label><input type="text" id="course" required></div>
          <div class="form-group"><label for="gender">Gender:</label>
            <select id="gender"><option value="FEMALE">FEMALE</option><option value="MALE">MALE</option><option value="OTHER">OTHER</option></select>
          </div>
          <div class="form-group"><label for="semester">Semester:</label>
            <select id="semester"><option value="1">1st</option><option value="2">2nd</option><option value="3">3rd</option><option value="4">4th</option><option value="5">5th</option><option value="6">6th</option></select>
          </div>
          <div class="form-group"><label for="examType">Exam Type:</label>
            <select id="examType"><option value="MAIN EXAM">Main</option><option value="BACK EXAM">Back</option><option value="EX-STUDENT EXAM">Ex-Student</option></select>
          </div>
          <div class="form-group"><label for="collegeName">College Name:</label><input type="text" id="collegeName" required></div>
          <div class="form-group"><label for="examCenter">Examination Center:</label><input type="text" id="examCenter" required></div>
          <div class="form-group"><label for="subject">Main Subject:</label><input type="text" id="subject" required></div>
        </div>
        <div id="papers-container">
          <h2>Paper Details</h2>
          <div id="paper-entries"></div>
          <button type="button" id="addPaperBtn" style="background-color:#17a2b8; margin-top:10px;">Add Paper</button>
        </div>
      </form>
    </div>

    <!-- Auto-fill -->
    <div id="auto-fill-section" style="display:none;">
      <label for="admitCardUpload">Upload Admit Card to Auto-Fill Details</label>
      <input type="file" id="admitCardUpload" accept=".pdf,.png,.jpg,.jpeg">
      <p id="upload-status" style="color: #007BFF; font-weight: bold;"></p>
    </div>
  </div>

  <!-- Action buttons -->
  <div class="action-buttons">
    <button type="button" id="generateBtn">GET Admit Card</button>
    <button type="button" id="downloadBtn" style="display:none;">Download as PDF</button>
  </div>

  <!-- ADMIT CARD -->
  <div id="admit-card-wrapper" style="display:none;">
    <div id="admit-card-content">
      <div class="header">
        <img src="https://i.ibb.co/nMC0877T/UNIVERSITY-UPDATES-LOGO-removebg-preview.png" alt="Logo">
        <h3>University Updates</h3>
        <div class="header-right"></div>
      </div>
      <div class="sub-header"><h4>औपबंधिक प्रवेश-पत्र / PROVISIONAL ADMIT CARD</h4></div>
      <p id="exam-type-sem" style="text-align:center; font-weight:bold; margin-bottom:15px;">COLLEGE EXAMINATION/MAIN EXAM/4'TH SEMESTER: JUNE-2025</p>
      <table class="details-table">
        <tr><td class="label">Roll Number:</td><td class="value" id="ac-rollNumber"></td><td class="label">Enrollment No:</td><td class="value" id="ac-enrollmentNumber"></td></tr>
        <tr><td class="label">Candidate Name:</td><td class="value" id="ac-candidateName"></td><td class="label">Father's/Mother's Name:</td><td class="value" id="ac-fatherMotherName"></td></tr>
        <tr><td class="label">Course:</td><td class="value" id="ac-course"></td><td class="label">Gender:</td><td class="value" id="ac-gender"></td></tr>
        <tr><td class="label">College Name:</td><td class="value" id="ac-collegeName"></td><td class="label">Exam Center:</td><td class="value" id="ac-examCenter"></td></tr>
        <tr><td class="label">Subject:</td><td class="value" colspan="3" id="ac-subject"></td></tr>
      </table>
      <table class="papers-table" id="ac-papers-table">
        <thead><tr><th>PAPER</th><th>PAPER CODE</th><th>PAPER NAME</th><th>PAPER TYPE</th><th>EXAM DATE</th><th>DAY</th><th>SHIFT</th></tr></thead>
        <tbody></tbody>
      </table>
      <p class="footer-note">
        NOTE: Please verify the examination dates and shifts on the university website www.ccsuniversity.ac.in.  
        This is for information purposes only.
      </p>
      <p class="footer-note">Datesheet updated on: 05-09-2025 12:45 AM</p>
    </div>
  </div>

     <script>
        // --- DATA (Datesheet wagerah yahan hai) ---
        const examDatesheet = { 'C010401T': { date: '29-Apr-2025', day: 'Tuesday', shift: 'Shift 2 (11:00 AM - 2:00 PM)' }, 'C010402T': { date: '02-May-2025', day: 'Friday', shift: 'Shift 2 (11:00 AM - 2:00 PM)' }, 'C010404T': { date: '03-May-2025', day: 'Saturday', shift: 'Shift 2 (11:00 AM - 2:00 PM)' }, 'C010403P': { date: 'N/A', day: 'N/A', shift: 'N/A' }, 'Q10021': { date: '22-May-2025', day: 'Thursday', shift: 'Shift 1 (8:00 AM - 11:00 AM)' }, 'V0001015P': { date: 'N/A', day: 'N/A', shift: 'N/A' }, 'V0001015T': { date: 'N/A', day: 'N/A', shift: 'N/A' }, 'Z040401': { date: '20-May-2025', day: 'Tuesday', shift: 'Shift 1 (8:00 AM - 11:00 AM)' }, 'A040201T': { date: '28-Apr-2025', day: 'Monday', shift: 'Shift 1 (8:00 AM - 11:00 AM)' }, 'C010201T': { date: '28-Apr-2025', day: 'Monday', shift: 'Shift 2 (11:00 AM - 2:00 PM)' }, 'A040401T': { date: '29-Apr-2025', day: 'Tuesday', shift: 'Shift 1 (8:00 AM - 11:00 AM)' }, 'C010202T': { date: '30-Apr-2025', day: 'Wednesday', shift: 'Shift 2 (11:00 AM - 2:00 PM)' }, 'A050401T': { date: '02-May-2025', day: 'Friday', shift: 'Shift 1 (8:00 AM - 11:00 AM)' }, 'Z020201': { date: '19-May-2025', day: 'Monday', shift: 'Shift 1 (8:00 AM - 11:00 AM)' }, 'Z060601': { date: '20-May-2025', day: 'Tuesday', shift: 'Shift 2 (11:00 AM - 2:00 PM)' } };

        const paperEntriesContainer = document.getElementById('paper-entries');
        const manualBtn = document.getElementById('manualBtn');
        const autoBtn = document.getElementById('autoBtn');
        const manualForm = document.getElementById('manual-form');
        const autoFillSection = document.getElementById('auto-fill-section');

        // --- UI TOGGLE (Manual aur Auto ke beech switch karne ke liye) ---
        manualBtn.addEventListener('click', () => { manualForm.style.display = 'block'; autoFillSection.style.display = 'none'; manualBtn.classList.add('active'); autoBtn.classList.remove('active'); });
        autoBtn.addEventListener('click', () => { manualForm.style.display = 'none'; autoFillSection.style.display = 'block'; manualBtn.classList.remove('active'); autoBtn.classList.add('active'); });

        // --- FORM HANDLING (Naya paper add karne ke liye) ---
        function addPaperEntry(paper = { code: '', name: '', type: '' }) {
            const div = document.createElement('div');
            div.className = 'paper-entry';
            div.innerHTML = `<input type="text" placeholder="Paper Code" value="${paper.code}" required> <input type="text" placeholder="Paper Name" value="${paper.name}" required> <input type="text" placeholder="Paper Type" value="${paper.type}" required>`;
            paperEntriesContainer.appendChild(div);
        }
        document.getElementById('addPaperBtn').addEventListener('click', () => addPaperEntry());

        // --- File Upload Handling ---
        document.getElementById('admitCardUpload').addEventListener('change', handleFileUpload);
        
        function handleFileUpload(event) {
            if (!event.target.files || event.target.files.length === 0) { return; }
            const status = document.getElementById('upload-status');
            status.textContent = 'Processing...';

            // ==============================================================================
            // YAHAN ASLI FIX KARNA HOGA - Yeh abhi bhi FAKE/SIMULATED data hi use kar raha hai
            // ==============================================================================
            
            // Asli code ke liye, aapko Tesseract.js (image ke liye) ya PDF.js (PDF ke liye)
            // jaisi library ka istemal karna hoga. Niche ek Tesseract.js ka example hai
            // jo abhi comment out kiya gaya hai.

            /*
            const file = event.target.files[0];
            Tesseract.recognize(file, 'eng', { logger: m => console.log(m) })
                .then(({ data: { text } }) => {
                    console.log("Image se nikala gaya text:", text);
                    // YAHAN AAPKO TEXT MEIN SE NAME, ROLL NUMBER NIKALNE KA LOGIC LIKHNA HOGA
                    status.textContent = 'Text extracted! Parsing data...';
                    // Example:
                    // const rollNo = text.match(/Roll Number: (\w+)/)[1];
                    // document.getElementById('rollNumber').value = rollNo;
                })
                .catch(err => {
                    console.error("Error processing image:", err);
                    status.textContent = 'Failed to read data from image.';
                });
            */
            
            // Abhi ke liye, hum purana SIMULATION wala code hi chala rahe hain
            setTimeout(() => {
                const extractedData = {
                    candidateName: "SNEHA RAWAT", fatherName: "GYANANDRA SINGH", motherName: "ANITA DEVI",
                    rollNumber: "RC230028001520", enrollmentNumber: "M230095101", course: "B.COM (NEP)",
                    gender: "FEMALE", semester: "4", examType: "MAIN EXAM",
                    collegeName: "0028-S.S.V. (P.G.) COLLEGE, HAPUR", examCenter: "0028-S.S.V. (P.G.) COLLEGE, HAPUR",
                    subject: "COMMERCE",
                    papers: [ { code: 'C010401T', name: 'INCOME TAX LAW AND ACCOUNTS', type: 'Theory, Internal' }, { code: 'C010402T', name: 'FUNDAMENTALS OF MARKETING', type: 'Theory, Internal' }, { code: 'C010403P', name: 'DIGITAL MARKETING', type: 'Practical, Internal' }, { code: 'C010404T', name: 'FUNDAMENTALS OF ENTREPRENEURSHIP', type: 'Theory, Internal' }, { code: 'Q10021', name: 'AN INTRODUCTION TO CONSTITUTION OF INDIA', type: 'Minor' }, { code: 'V0001015P', name: 'YOGA AND CORRECTIVES', type: 'Vocational' }, { code: 'V0001015T', name: 'YOGA AND CORRECTIVES', type: 'Vocational' }, { code: 'Z040401', name: 'PHYSICAL EDUCATION AND YOGA', type: 'Co Curricular' }, ]
                };
                
                fillFormWithData(extractedData);
                status.textContent = 'Sample Details Fetched! Switch to Manual Entry to view.';
            }, 1500);
        }

        function fillFormWithData(data) {
            document.getElementById('candidateName').value = data.candidateName;
            document.getElementById('fatherName').value = data.fatherName;
            document.getElementById('motherName').value = data.motherName;
            document.getElementById('rollNumber').value = data.rollNumber;
            document.getElementById('enrollmentNumber').value = data.enrollmentNumber;
            document.getElementById('course').value = data.course;
            document.getElementById('gender').value = data.gender;
            document.getElementById('semester').value = data.semester;
            document.getElementById('examType').value = data.examType;
            document.getElementById('collegeName').value = data.collegeName;
            document.getElementById('examCenter').value = data.examCenter;
            document.getElementById('subject').value = data.subject;

            paperEntriesContainer.innerHTML = ''; // Purane papers hata do
            data.papers.forEach(addPaperEntry);
        }

        // --- ADMIT CARD GENERATION (Form se data lekar card banane ke liye) ---
        document.getElementById('generateBtn').addEventListener('click', () => {
            const candidateName = document.getElementById('candidateName').value, fatherName = document.getElementById('fatherName').value,
                  motherName = document.getElementById('motherName').value, rollNumber = document.getElementById('rollNumber').value,
                  enrollmentNumber = document.getElementById('enrollmentNumber').value, course = document.getElementById('course').value,
                  gender = document.getElementById('gender').value, semester = document.getElementById('semester').value,
                  examType = document.getElementById('examType').value, collegeName = document.getElementById('collegeName').value,
                  examCenter = document.getElementById('examCenter').value, subject = document.getElementById('subject').value;

            if (!candidateName || !rollNumber) { alert('Please fill at least the Candidate Name and Roll Number.'); return; }

            document.getElementById('ac-rollNumber').innerText = rollNumber;
            document.getElementById('ac-enrollmentNumber').innerText = enrollmentNumber;
            document.getElementById('ac-candidateName').innerText = candidateName.toUpperCase();
            document.getElementById('ac-fatherMotherName').innerText = `${fatherName.toUpperCase()}/${motherName.toUpperCase()}`;
            document.getElementById('ac-course').innerText = course.toUpperCase();
            document.getElementById('ac-gender').innerText = gender.toUpperCase();
            document.getElementById('ac-collegeName').innerText = collegeName;
            document.getElementById('ac-examCenter').innerText = examCenter;
            document.getElementById('ac-subject').innerText = subject.toUpperCase();
            document.getElementById('exam-type-sem').innerText = `COLLEGE EXAMINATION/${examType.toUpperCase()}/${semester}'TH SEMESTER: JUNE-2025`;

            const tableBody = document.querySelector("#ac-papers-table tbody");
            tableBody.innerHTML = '';
            document.querySelectorAll('.paper-entry').forEach((form, index) => {
                const code = form.children[0].value.toUpperCase();
                const name = form.children[1].value.toUpperCase();
                const type = form.children[2].value;
                if (!code || !name || !type) return;

                const examInfo = examDatesheet[code] || { date: 'Check Website', day: '-', shift: '-' };
                let rowHtml = `<tr><td>PAPER ${index + 1}</td><td>${code}</td><td>${name}</td><td>${type}</td>`;
                if (type.toLowerCase().includes('practical') || examInfo.date === 'N/A') {
                    rowHtml += `<td colspan="3" style="text-align:center;">Date and time to be decided by college.</td>`;
                } else {
                    rowHtml += `<td>${examInfo.date}</td><td>${examInfo.day}</td><td>${examInfo.shift}</td>`;
                }
                rowHtml += `</tr>`;
                tableBody.innerHTML += rowHtml;
            });

            document.getElementById('admit-card-wrapper').style.display = 'block';
            document.getElementById('downloadBtn').style.display = 'inline-block';
            document.getElementById('admit-card-wrapper').scrollIntoView({ behavior: 'smooth' });
        });

        // --- PDF DOWNLOAD ---
        document.getElementById('downloadBtn').addEventListener('click', () => {
            const element = document.getElementById('admit-card-content');
            const rollNumber = document.getElementById('rollNumber').value || 'AdmitCard';
            const opt = { margin: 0.2, filename: `Admit_Card_${rollNumber}.pdf`, image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2 }, jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' } };
            html2pdf().set(opt).from(element).save();
        });
    </script>


</body>
</html>
