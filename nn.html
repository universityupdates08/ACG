<!DOCTYPE html>
<html>
<head>
<style>
  /* --- 1. BASE STYLES --- */
  body { 
    font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
    background: #ffffff; 
    padding: 10px; 
    margin: 0; 
  }

  /* Header */
  .feed-header {
    border-bottom: 2px solid #003366; /* University Blue */
    padding-bottom: 10px;
    margin-bottom: 15px;
    color: #003366;
    font-size: 18px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  /* Status Badge (Live/Loading) */
  .badge {
    font-size: 11px;
    padding: 4px 8px;
    border-radius: 12px;
    background: #f0f0f0;
    color: #666;
    font-weight: normal;
  }

  /* --- 2. NEWS CARD STYLES --- */
  .news-container { 
    display: flex; 
    flex-direction: column; 
    gap: 10px; 
  }
  
  .news-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #f8f9fa; /* Light Gray */
    border-left: 5px solid #003366;
    padding: 12px 15px;
    border-radius: 4px;
    text-decoration: none;
    color: #333;
    transition: background 0.2s;
    border: 1px solid #eee;
  }

  .news-card:hover { 
    background: #e9ecef; 
  }

  .news-content { flex: 1; padding-right: 15px; }
  
  .news-date {
    font-size: 11px;
    color: #d32f2f; /* Red for Date */
    font-weight: 700;
    margin-bottom: 3px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .news-title { 
    font-size: 14px; 
    line-height: 1.4; 
    font-weight: 500; 
    color: #000;
  }
  
  .download-btn {
    background: #003366;
    color: white;
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 11px;
    white-space: nowrap;
    font-weight: bold;
  }

  /* --- 3. SKELETON LOADING (GHOST EFFECT) --- */
  /* This shows while data is loading so it looks "fixed" in HTML */
  .skeleton-wrapper { display: block; }
  
  .skeleton {
    background: #fff;
    border: 1px solid #eee;
    border-left: 5px solid #ddd;
    border-radius: 4px;
    padding: 12px 15px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .sk-text { flex: 1; }
  .sk-line { height: 10px; background: #eee; margin-bottom: 6px; width: 70%; border-radius: 2px; }
  .sk-line.short { width: 30%; height: 8px; margin-bottom: 8px; }
  .sk-btn { width: 60px; height: 25px; background: #eee; border-radius: 4px; }

  /* Animation for loading */
  @keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }
  .skeleton { animation: pulse 1.5s infinite ease-in-out; }

</style>
</head>
<body>

<div class="feed-header">
  <span>üìù Latest Notices</span>
  <span id="status" class="badge">Updating...</span>
</div>

<div id="skeleton-box" class="skeleton-wrapper">
  <div class="skeleton"><div class="sk-text"><div class="sk-line short"></div><div class="sk-line"></div></div><div class="sk-btn"></div></div>
  <div class="skeleton"><div class="sk-text"><div class="sk-line short"></div><div class="sk-line"></div></div><div class="sk-btn"></div></div>
  <div class="skeleton"><div class="sk-text"><div class="sk-line short"></div><div class="sk-line"></div></div><div class="sk-btn"></div></div>
  <div class="skeleton"><div class="sk-text"><div class="sk-line short"></div><div class="sk-line"></div></div><div class="sk-btn"></div></div>
</div>

<div id="news-feed" class="news-container"></div>

<script>
  // ============================================
  //  üëá PASTE YOUR API URL INSIDE THE QUOTES üëá
  // ============================================
  const API_URL = 'https://api.ccsuniversity.ac.in/news/search?title=&id=Notice&month=&year=&page=1'; 
  // ============================================

  const feedContainer = document.getElementById('news-feed');
  const skeletonBox = document.getElementById('skeleton-box');
  const statusBadge = document.getElementById('status');

  function formatDate(isoString) {
    if (!isoString) return '';
    const date = new Date(isoString);
    const day = date.getDate();
    const month = date.toLocaleString('default', { month: 'short' }).toUpperCase();
    const year = date.getFullYear();
    return `${day} ${month} ${year}`;
  }

  async function loadData() {
    try {
      // We add '?t=' + timestamp to the URL.
      // This forces the browser to think it is a NEW request every time.
      // It ensures NO CACHE is used.
      const noCacheUrl = API_URL + (API_URL.includes('?') ? '&' : '?') + 't=' + new Date().getTime();

      const response = await fetch(noCacheUrl);
      if (!response.ok) throw new Error("Server Error");

      const data = await response.json();
      const newsList = data.news;

      // Clear Skeleton
      skeletonBox.style.display = 'none';

      if (!newsList || newsList.length === 0) {
        feedContainer.innerHTML = '<div style="padding:10px;">No notices found.</div>';
        return;
      }

      // Render Items
      newsList.forEach(item => {
        const card = document.createElement('a');
        card.className = 'news-card';
        card.href = item.url;
        card.target = '_blank'; // Opens in new tab

        const dateStr = formatDate(item.created_at);

        card.innerHTML = `
          <div class="news-content">
            <div class="news-date">üìÖ ${dateStr}</div>
            <div class="news-title">${item.title}</div>
          </div>
          <div class="download-btn">OPEN PDF</div>
        `;
        
        feedContainer.appendChild(card);
      });

      // Update Badge
      statusBadge.innerText = "Live Feed";
      statusBadge.style.background = "#e6fffa";
      statusBadge.style.color = "#006666";

    } catch (error) {
      console.error(error);
      skeletonBox.style.display = 'none';
      feedContainer.innerHTML = `<div style="color:red; padding:10px; border:1px solid red; background:#fff5f5;">
        <strong>Connection Failed</strong><br>
        Could not load API.
      </div>`;
    }
  }

  // Run immediately
  loadData();

</script>

</body>
</html>
